<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reciprocal Attention: Logo & Concepts</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px;
            background: #f5f5f0;
            color: #2c3e50;
        }
        
        .section {
            background: white;
            padding: 30px;
            margin: 30px 0;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #5da5a5;
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        h2 {
            color: #d17a4f;
            border-bottom: 3px solid #5da5a5;
            padding-bottom: 10px;
            margin-top: 40px;
        }
        
        h3 {
            color: #5da5a5;
            margin-top: 30px;
        }
        
        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
            background: linear-gradient(135deg, #f5f5f0 0%, #e8e8e0 100%);
            border-radius: 12px;
            margin: 20px 0;
        }
        
        svg {
            max-width: 100%;
            height: auto;
        }
        
        .diagram-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }
        
        .diagram-container {
            background: #fafafa;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }
        
        .diagram-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.1em;
        }
        
        .key-insight {
            background: #fff3e0;
            border-left: 5px solid #d17a4f;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .key-insight strong {
            color: #d17a4f;
            display: block;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .comparison-table th {
            background: #5da5a5;
            color: white;
            font-weight: bold;
        }
        
        .comparison-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #c7254e;
        }
        
        .math {
            font-style: italic;
            color: #5da5a5;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="section">
        <h1>Reciprocal Attention (RA)</h1>
        <p style="text-align: center; color: #666; font-size: 1.2em;">
            Bidirectional Information Flow for Efficient Attention
        </p>
        
        <div class="logo-container">
            <svg width="400" height="400" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
                <!-- Background circle -->
                <circle cx="200" cy="200" r="180" fill="#f5f5f0" stroke="#334d5c" stroke-width="3"/>
                
                <!-- Central token (magnifying glass concept - represents discoverability) -->
                <circle cx="200" cy="200" r="50" fill="#5da5a5" stroke="#334d5c" stroke-width="4"/>
                
                <!-- Reciprocal arrows forming a cycle around center -->
                <!-- Top token -->
                <circle cx="200" cy="80" r="30" fill="#d17a4f" stroke="#334d5c" stroke-width="3"/>
                
                <!-- Right token -->
                <circle cx="320" cy="200" r="30" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                
                <!-- Bottom token -->
                <circle cx="200" cy="320" r="30" fill="#d17a4f" stroke="#334d5c" stroke-width="3"/>
                
                <!-- Left token -->
                <circle cx="80" cy="200" r="30" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                
                <!-- Forward arrows (standard attention) - curved, going clockwise -->
                <defs>
                    <marker id="arrowhead-forward" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#d17a4f" />
                    </marker>
                    <marker id="arrowhead-reverse" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#5da5a5" />
                    </marker>
                </defs>
                
                <!-- Forward attention (Q¬∑K^T) - orange curved arrows -->
                <path d="M 220 90 Q 270 110 310 180" stroke="#d17a4f" stroke-width="4" fill="none" marker-end="url(#arrowhead-forward)"/>
                <path d="M 310 220 Q 270 290 220 310" stroke="#d17a4f" stroke-width="4" fill="none" marker-end="url(#arrowhead-forward)"/>
                <path d="M 180 310 Q 130 290 90 220" stroke="#d17a4f" stroke-width="4" fill="none" marker-end="url(#arrowhead-forward)"/>
                <path d="M 90 180 Q 130 110 180 90" stroke="#d17a4f" stroke-width="4" fill="none" marker-end="url(#arrowhead-forward)"/>
                
                <!-- Reverse attention (K¬∑Q^T = S^T) - teal curved arrows going opposite direction -->
                <path d="M 310 190 Q 260 120 210 95" stroke="#5da5a5" stroke-width="4" fill="none" marker-end="url(#arrowhead-reverse)"/>
                <path d="M 210 305 Q 260 280 305 210" stroke="#5da5a5" stroke-width="4" fill="none" marker-end="url(#arrowhead-reverse)"/>
                <path d="M 95 210 Q 140 280 190 305" stroke="#5da5a5" stroke-width="4" fill="none" marker-end="url(#arrowhead-reverse)"/>
                <path d="M 190 95 Q 140 120 95 190" stroke="#5da5a5" stroke-width="4" fill="none" marker-end="url(#arrowhead-reverse)"/>
                
                <!-- Broadcast lines from center (discoverability) - dashed -->
                <line x1="200" y1="200" x2="200" y2="80" stroke="#5da5a5" stroke-width="2" stroke-dasharray="5,5" opacity="0.6"/>
                <line x1="200" y1="200" x2="320" y2="200" stroke="#5da5a5" stroke-width="2" stroke-dasharray="5,5" opacity="0.6"/>
                <line x1="200" y1="200" x2="200" y2="320" stroke="#5da5a5" stroke-width="2" stroke-dasharray="5,5" opacity="0.6"/>
                <line x1="200" y1="200" x2="80" y2="200" stroke="#5da5a5" stroke-width="2" stroke-dasharray="5,5" opacity="0.6"/>
                
                <!-- Magnifying glass handle -->
                <line x1="235" y1="235" x2="270" y2="270" stroke="#334d5c" stroke-width="8" stroke-linecap="round"/>
                
                <!-- Legend text -->
                <text x="200" y="370" text-anchor="middle" font-size="16" font-weight="bold" fill="#334d5c">
                    Reciprocal Attention
                </text>
            </svg>
        </div>
        
        <div style="text-align: center; margin-top: 20px; color: #666;">
            <p><strong style="color: #d17a4f;">‚óè</strong> Forward Attention (Q¬∑K<sup>T</sup>) &nbsp;&nbsp;
               <strong style="color: #5da5a5;">‚óè</strong> Reciprocal Attention (S<sup>T</sup>) &nbsp;&nbsp;
               <strong style="color: #5da5a5;">‚ö¨</strong> Discoverability Broadcast</p>
        </div>
    </div>

    <div class="section">
        <h2>Understanding PageRank vs RWR: The Foundation</h2>
        
        <h3>What is PageRank?</h3>
        <p>PageRank is Google's original algorithm for ranking web pages. It models the web as a directed graph where:</p>
        <ul>
            <li>Nodes = web pages</li>
            <li>Edges = hyperlinks from one page to another</li>
            <li>A "random surfer" clicks links randomly, occasionally teleporting to a random page</li>
        </ul>
        
        <div class="diagram-grid">
            <div class="diagram-container">
                <div class="diagram-title">PageRank: Global Ranking</div>
                <svg width="100%" height="300" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                    <!-- Nodes -->
                    <circle cx="200" cy="50" r="30" fill="#d17a4f" stroke="#334d5c" stroke-width="3"/>
                    <text x="200" y="58" text-anchor="middle" fill="white" font-size="20" font-weight="bold">A</text>
                    <text x="200" y="95" text-anchor="middle" fill="#334d5c" font-size="14">PR: 0.35</text>
                    
                    <circle cx="100" cy="150" r="25" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                    <text x="100" y="157" text-anchor="middle" fill="white" font-size="18" font-weight="bold">B</text>
                    <text x="100" y="195" text-anchor="middle" fill="#334d5c" font-size="14">PR: 0.15</text>
                    
                    <circle cx="300" cy="150" r="25" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                    <text x="300" y="157" text-anchor="middle" fill="white" font-size="18" font-weight="bold">C</text>
                    <text x="300" y="195" text-anchor="middle" fill="#334d5c" font-size="14">PR: 0.15</text>
                    
                    <circle cx="150" cy="240" r="25" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                    <text x="150" y="247" text-anchor="middle" fill="white" font-size="18" font-weight="bold">D</text>
                    <text x="150" y="275" text-anchor="middle" fill="#334d5c" font-size="14">PR: 0.20</text>
                    
                    <circle cx="250" cy="240" r="25" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                    <text x="250" y="247" text-anchor="middle" fill="white" font-size="18" font-weight="bold">E</text>
                    <text x="250" y="275" text-anchor="middle" fill="#334d5c" font-size="14">PR: 0.15</text>
                    
                    <!-- Edges -->
                    <defs>
                        <marker id="arrow-pr" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
                            <polygon points="0 0, 8 3, 0 6" fill="#334d5c" />
                        </marker>
                    </defs>
                    
                    <path d="M 180 65 L 120 135" stroke="#334d5c" stroke-width="2" marker-end="url(#arrow-pr)"/>
                    <path d="M 220 65 L 280 135" stroke="#334d5c" stroke-width="2" marker-end="url(#arrow-pr)"/>
                    <path d="M 110 175 L 140 215" stroke="#334d5c" stroke-width="2" marker-end="url(#arrow-pr)"/>
                    <path d="M 290 175 L 260 215" stroke="#334d5c" stroke-width="2" marker-end="url(#arrow-pr)"/>
                    <path d="M 175 235 L 225 235" stroke="#334d5c" stroke-width="2" marker-end="url(#arrow-pr)"/>
                    <path d="M 155 215 L 195 75" stroke="#334d5c" stroke-width="2" marker-end="url(#arrow-pr)"/>
                    <path d="M 245 215 L 205 75" stroke="#334d5c" stroke-width="2" marker-end="url(#arrow-pr)"/>
                    
                    <!-- Teleport arrows (random jumps) -->
                    <text x="200" y="20" text-anchor="middle" fill="#d17a4f" font-size="12">‚ö° random teleport</text>
                </svg>
                <p style="margin-top: 15px; font-size: 0.95em; color: #555;">
                    <strong>Key:</strong> PageRank computes a <em>single global score</em> for each page. 
                    Every page gets one importance value. Node A has highest PageRank because many paths lead to it.
                </p>
            </div>
            
            <div class="diagram-container">
                <div class="diagram-title">RWR: Personalized Ranking from Source</div>
                <svg width="100%" height="300" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                    <!-- Nodes -->
                    <circle cx="200" cy="50" r="30" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                    <text x="200" y="58" text-anchor="middle" fill="white" font-size="20" font-weight="bold">A</text>
                    <text x="200" y="95" text-anchor="middle" fill="#334d5c" font-size="14">r(B‚ÜíA): 0.25</text>
                    
                    <circle cx="100" cy="150" r="30" fill="#5da5a5" stroke="#334d5c" stroke-width="4"/>
                    <text x="100" y="158" text-anchor="middle" fill="white" font-size="20" font-weight="bold">B</text>
                    <text x="100" y="195" text-anchor="middle" fill="#5da5a5" font-size="14" font-weight="bold">QUERY</text>
                    
                    <circle cx="300" cy="150" r="25" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                    <text x="300" y="157" text-anchor="middle" fill="white" font-size="18" font-weight="bold">C</text>
                    <text x="300" y="195" text-anchor="middle" fill="#334d5c" font-size="14">r(B‚ÜíC): 0.10</text>
                    
                    <circle cx="150" cy="240" r="30" fill="#d17a4f" stroke="#334d5c" stroke-width="3"/>
                    <text x="150" y="248" text-anchor="middle" fill="white" font-size="20" font-weight="bold">D</text>
                    <text x="150" y="275" text-anchor="middle" fill="#334d5c" font-size="14">r(B‚ÜíD): 0.40</text>
                    
                    <circle cx="250" cy="240" r="25" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                    <text x="250" y="247" text-anchor="middle" fill="white" font-size="18" font-weight="bold">E</text>
                    <text x="250" y="275" text-anchor="middle" fill="#334d5c" font-size="14">r(B‚ÜíE): 0.25</text>
                    
                    <!-- Edges with heat map coloring -->
                    <defs>
                        <marker id="arrow-rwr" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
                            <polygon points="0 0, 8 3, 0 6" fill="#d17a4f" />
                        </marker>
                    </defs>
                    
                    <path d="M 180 65 L 120 135" stroke="#334d5c" stroke-width="2" opacity="0.3"/>
                    <path d="M 220 65 L 280 135" stroke="#334d5c" stroke-width="2" opacity="0.3"/>
                    <path d="M 110 175 L 140 215" stroke="#d17a4f" stroke-width="4" marker-end="url(#arrow-rwr)"/>
                    <path d="M 290 175 L 260 215" stroke="#334d5c" stroke-width="2" opacity="0.3"/>
                    <path d="M 175 235 L 225 235" stroke="#d17a4f" stroke-width="3" opacity="0.6"/>
                    <path d="M 155 215 L 195 75" stroke="#d17a4f" stroke-width="3" opacity="0.5"/>
                    <path d="M 245 215 L 205 75" stroke="#d17a4f" stroke-width="3" opacity="0.5"/>
                    
                    <!-- Restart arrow -->
                    <path d="M 85 160 Q 60 150 70 135" stroke="#5da5a5" stroke-width="3" fill="none" marker-end="url(#arrow-rwr)" stroke-dasharray="4,4"/>
                    <text x="50" y="145" text-anchor="middle" fill="#5da5a5" font-size="11" font-weight="bold">restart</text>
                </svg>
                <p style="margin-top: 15px; font-size: 0.95em; color: #555;">
                    <strong>Key:</strong> RWR computes <em>personalized scores relative to query node B</em>. 
                    Random walk starts at B, explores neighbors, but randomly restarts at B. 
                    Node D scores highest from B's perspective.
                </p>
            </div>
        </div>
        
        <div class="key-insight">
            <strong>üîë The Critical Difference:</strong>
            <ul style="margin: 10px 0 0 0;">
                <li><strong>PageRank:</strong> One global score per node. Same importance everywhere. <span class="math">PR(i)</span> is context-free.</li>
                <li><strong>RWR:</strong> Each query node gets its own personalized view. <span class="math">r(q‚Üíi)</span> depends on who's asking.</li>
            </ul>
        </div>
        
        <h3>The Math: What's Really Different</h3>
        
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Aspect</th>
                    <th>PageRank</th>
                    <th>RWR (Random Walk with Restart)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Question</strong></td>
                    <td>"How important is this page?"</td>
                    <td>"How relevant is this page <em>to me</em>?"</td>
                </tr>
                <tr>
                    <td><strong>Random Walk</strong></td>
                    <td>Start anywhere, teleport to random page</td>
                    <td>Always restart at query node</td>
                </tr>
                <tr>
                    <td><strong>Stationary Distribution</strong></td>
                    <td><code>œÄ = Œ±PœÄ + (1-Œ±)e/n</code><br/>(uniform teleport)</td>
                    <td><code>r = Œ±Pr + (1-Œ±)e_q</code><br/>(restart at query q)</td>
                </tr>
                <tr>
                    <td><strong>Output</strong></td>
                    <td>One vector <span class="math">œÄ ‚àà ‚Ñù<sup>n</sup></span></td>
                    <td>Query-specific vector <span class="math">r<sub>q</sub> ‚àà ‚Ñù<sup>n</sup></span></td>
                </tr>
                <tr>
                    <td><strong>Complexity</strong></td>
                    <td>Solve once for all nodes</td>
                    <td>Solve separately per query</td>
                </tr>
                <tr>
                    <td><strong>Attention Analogy</strong></td>
                    <td>Global token importance</td>
                    <td>Query-specific attention weights</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="section">
        <h2>Why Reciprocal Attention is a Perfect Fit for RWR</h2>
        
        <h3>The Problem: Attention Creates an Asymmetric Graph</h3>
        <p>Standard attention computes <code>S = Q @ K.T</code>, which creates a <strong>directed</strong> graph:</p>
        <ul>
            <li>Token i attends to token j with weight S[i,j]</li>
            <li>But S[i,j] ‚â† S[j,i] in general</li>
            <li>This asymmetry makes the graph <strong>non-reversible</strong></li>
        </ul>
        
        <div class="diagram-container" style="margin: 30px 0;">
            <div class="diagram-title">Standard Attention: Asymmetric Graph</div>
            <svg width="100%" height="250" viewBox="0 0 600 250" xmlns="http://www.w3.org/2000/svg">
                <!-- Tokens -->
                <circle cx="100" cy="125" r="35" fill="#d17a4f" stroke="#334d5c" stroke-width="3"/>
                <text x="100" y="133" text-anchor="middle" fill="white" font-size="20" font-weight="bold">i</text>
                
                <circle cx="300" cy="125" r="35" fill="#5da5a5" stroke="#334d5c" stroke-width="3"/>
                <text x="300" y="133" text-anchor="middle" fill="white" font-size="20" font-weight="bold">j</text>
                
                <circle cx="500" cy="125" r="35" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                <text x="500" y="133" text-anchor="middle" fill="white" font-size="20" font-weight="bold">k</text>
                
                <!-- Asymmetric edges -->
                <defs>
                    <marker id="arrow-asym" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#334d5c" />
                    </marker>
                </defs>
                
                <!-- i -> j (strong) -->
                <path d="M 135 110 L 265 110" stroke="#d17a4f" stroke-width="6" marker-end="url(#arrow-asym)"/>
                <text x="200" y="100" text-anchor="middle" fill="#d17a4f" font-size="14" font-weight="bold">S[i,j] = 0.8</text>
                
                <!-- j -> i (weak) -->
                <path d="M 265 140 L 135 140" stroke="#5da5a5" stroke-width="2" marker-end="url(#arrow-asym)"/>
                <text x="200" y="165" text-anchor="middle" fill="#5da5a5" font-size="14">S[j,i] = 0.1</text>
                
                <!-- j -> k (medium) -->
                <path d="M 335 110 L 465 110" stroke="#5da5a5" stroke-width="4" marker-end="url(#arrow-asym)"/>
                <text x="400" y="100" text-anchor="middle" fill="#5da5a5" font-size="14">S[j,k] = 0.4</text>
                
                <!-- k -> j (medium-weak) -->
                <path d="M 465 140 L 335 140" stroke="#7a8a99" stroke-width="3" marker-end="url(#arrow-asym)"/>
                <text x="400" y="165" text-anchor="middle" fill="#7a8a99" font-size="14">S[k,j] = 0.3</text>
                
                <text x="300" y="220" text-anchor="middle" fill="#c0392b" font-size="16" font-weight="bold">
                    ‚ö† Asymmetric: S[i,j] ‚â† S[j,i]
                </text>
            </svg>
        </div>
        
        <div class="key-insight">
            <strong>üö´ Why Asymmetry is Bad for RWR:</strong>
            <ul style="margin: 10px 0 0 0;">
                <li><strong>No Detailed Balance:</strong> The Markov chain can't guarantee convergence to a nice stationary distribution</li>
                <li><strong>Inefficient Diffusion:</strong> Information flows more easily in one direction than the other</li>
                <li><strong>Unstable Iterations:</strong> Power iteration for solving <span class="math">r = Œ±Pr + (1-Œ±)e<sub>q</sub></span> can oscillate</li>
            </ul>
        </div>
        
        <h3>The Solution: Reciprocal Attention Creates Reversibility</h3>
        <p>RA adds the transpose <code>S_rec = S.T</code> to the attention mechanism. This creates <strong>symmetric edges</strong>:</p>
        
        <div class="diagram-container" style="margin: 30px 0;">
            <div class="diagram-title">Reciprocal Attention: Symmetric Graph (Reversible)</div>
            <svg width="100%" height="300" viewBox="0 0 600 300" xmlns="http://www.w3.org/2000/svg">
                <!-- Tokens -->
                <circle cx="100" cy="150" r="35" fill="#d17a4f" stroke="#334d5c" stroke-width="3"/>
                <text x="100" y="158" text-anchor="middle" fill="white" font-size="20" font-weight="bold">i</text>
                
                <circle cx="300" cy="150" r="35" fill="#5da5a5" stroke="#334d5c" stroke-width="3"/>
                <text x="300" y="158" text-anchor="middle" fill="white" font-size="20" font-weight="bold">j</text>
                
                <circle cx="500" cy="150" r="35" fill="#7a8a99" stroke="#334d5c" stroke-width="3"/>
                <text x="500" y="158" text-anchor="middle" fill="white" font-size="20" font-weight="bold">k</text>
                
                <!-- Bidirectional edges -->
                <defs>
                    <marker id="arrow-bidir-fwd" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#d17a4f" />
                    </marker>
                    <marker id="arrow-bidir-rev" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#5da5a5" />
                    </marker>
                </defs>
                
                <!-- i <-> j -->
                <path d="M 135 130 L 265 130" stroke="#d17a4f" stroke-width="5" marker-end="url(#arrow-bidir-fwd)"/>
                <text x="200" y="120" text-anchor="middle" fill="#d17a4f" font-size="13" font-weight="bold">S[i,j] = 0.8</text>
                
                <path d="M 265 170 L 135 170" stroke="#5da5a5" stroke-width="5" marker-end="url(#arrow-bidir-rev)"/>
                <text x="200" y="195" text-anchor="middle" fill="#5da5a5" font-size="13" font-weight="bold">S[j,i] = 0.8</text>
                
                <!-- j <-> k -->
                <path d="M 335 130 L 465 130" stroke="#5da5a5" stroke-width="4" marker-end="url(#arrow-bidir-fwd)"/>
                <text x="400" y="120" text-anchor="middle" fill="#5da5a5" font-size="13">S[j,k] = 0.5</text>
                
                <path d="M 465 170 L 335 170" stroke="#7a8a99" stroke-width="4" marker-end="url(#arrow-bidir-rev)"/>
                <text x="400" y="195" text-anchor="middle" fill="#7a8a99" font-size="13">S[k,j] = 0.5</text>
                
                <!-- Combined weight annotation -->
                <text x="200" y="230" text-anchor="middle" fill="#334d5c" font-size="14">
                    w_std¬∑S[i,j] + w_rec¬∑S[j,i] ‚Üí symmetric
                </text>
                
                <text x="400" y="230" text-anchor="middle" fill="#334d5c" font-size="14">
                    w_std¬∑S[j,k] + w_rec¬∑S[k,j] ‚Üí symmetric
                </text>
                
                <text x="300" y="270" text-anchor="middle" fill="#27ae60" font-size="16" font-weight="bold">
                    ‚úì Reversible: Forward and Backward Flows Balanced
                </text>
            </svg>
        </div>
        
        <div class="key-insight">
            <strong>üéØ Why This is Perfect for RWR:</strong>
            <ul style="margin: 10px 0 0 0;">
                <li><strong>Detailed Balance:</strong> Combining S and S<sup>T</sup> makes the transition matrix satisfy detailed balance condition</li>
                <li><strong>Fast Convergence:</strong> Reversible chains converge exponentially fast to stationary distribution</li>
                <li><strong>Stable Iterations:</strong> Power method for RWR becomes provably stable</li>
                <li><strong>Natural Diffusion:</strong> Information flows equally well in both directions, like physical diffusion</li>
            </ul>
        </div>
        
        <h3>The Mathematical Connection</h3>
        
        <p>In standard attention, we compute attention weights and propagate information forward:</p>
        <pre style="background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>A = softmax(Q @ K.T / sqrt(d))  # attention weights
out = A @ V                      # weighted sum of values</code></pre>
        
        <p>This is equivalent to <strong>one step</strong> of a random walk on the token graph where edge weights are given by the attention matrix A.</p>
        
        <p>With Reciprocal Attention, we combine forward and reverse walks:</p>
        <pre style="background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>S = Q @ K.T
S_rec = S.T
logits = w_std * S + w_rec * S_rec + w_disc * d
A = softmax(logits / sqrt(d))</code></pre>
        
        <p>Now the attention matrix A represents a <strong>reversible Markov chain</strong> because:</p>
        <ul>
            <li>Forward flow (i‚Üíj) via S is balanced by reverse flow (j‚Üíi) via S<sup>T</sup></li>
            <li>The learned weights w_std and w_rec control the bidirectional mixing</li>
            <li>This satisfies detailed balance: <span class="math">œÄ<sub>i</sub>A<sub>ij</sub> = œÄ<sub>j</sub>A<sub>ji</sub></span></li>
        </ul>
        
        <p>RWR then extends this to multi-step diffusion:</p>
        <pre style="background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># RWR stationary distribution for query q
r = (1-Œ±)e_q + Œ± * A @ r     # iterative solver
# where A is the RA-derived transition matrix
# This converges FAST because A is reversible!</code></pre>
        
        <div class="key-insight">
            <strong>üí° The Beautiful Part:</strong>
            <p style="margin: 10px 0 0 0;">
                RA gives you reversibility <em>for free</em> (transpose costs nothing), which makes RWR mathematically 
                well-behaved and computationally efficient. The reciprocal structure isn't just a trick‚Äîit's the 
                natural way to turn attention into a proper diffusion process.
            </p>
        </div>
    </div>

    <div class="section">
        <h2>Why RWR + RA Together Are Powerful</h2>
        
        <div class="diagram-grid">
            <div class="diagram-container">
                <div class="diagram-title">Standard Attention: Dense O(n¬≤)</div>
                <svg width="100%" height="200" viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
                    <rect x="50" y="20" width="300" height="160" fill="#ffe6e6" stroke="#c0392b" stroke-width="2" rx="5"/>
                    <text x="200" y="110" text-anchor="middle" font-size="18" font-weight="bold" fill="#c0392b">
                        Full n√ón Matrix
                    </text>
                    <text x="200" y="135" text-anchor="middle" font-size="14" fill="#c0392b">
                        Every token attends to every token
                    </text>
                    <text x="200" y="160" text-anchor="middle" font-size="14" fill="#c0392b">
                        Memory: O(n¬≤), Compute: O(n¬≤d)
                    </text>
                </svg>
            </div>
            
            <div class="diagram-container">
                <div class="diagram-title">RA + RWR: Sparse O(n)</div>
                <svg width="100%" height="200" viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
                    <!-- Local window -->
                    <rect x="50" y="20" width="80" height="160" fill="#e8f5e9" stroke="#27ae60" stroke-width="2" rx="5"/>
                    <text x="90" y="105" text-anchor="middle" font-size="12" font-weight="bold" fill="#27ae60">LOCAL</text>
                    
                    <!-- Plus sign -->
                    <text x="165" y="110" text-anchor="middle" font-size="30" font-weight="bold" fill="#334d5c">+</text>
                    
                    <!-- RWR sparse -->
                    <circle cx="240" cy="50" r="12" fill="#5da5a5"/>
                    <circle cx="260" cy="80" r="12" fill="#5da5a5"/>
                    <circle cx="220" cy="110" r="12" fill="#5da5a5"/>
                    <circle cx="280" cy="130" r="12" fill="#5da5a5"/>
                    <circle cx="240" cy="160" r="12" fill="#5da5a5"/>
                    <line x1="240" y1="50" x2="260" y2="80" stroke="#5da5a5" stroke-width="2"/>
                    <line x1="260" y1="80" x2="220" y2="110" stroke="#5da5a5" stroke-width="2"/>
                    <line x1="220" y1="110" x2="280" y2="130" stroke="#5da5a5" stroke-width="2"/>
                    <line x1="280" y1="130" x2="240" y2="160" stroke="#5da5a5" stroke-width="2"/>
                    <text x="320" y="70" text-anchor="start" font-size="12" font-weight="bold" fill="#5da5a5">RWR</text>
                    <text x="320" y="90" text-anchor="start" font-size="11" fill="#5da5a5">sparse</text>
                    <text x="320" y="105" text-anchor="start" font-size="11" fill="#5da5a5">walks</text>
                </svg>
            </div>
        </div>
        
        <h3>Computational Benefits</h3>
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Aspect</th>
                    <th>Standard Attention</th>
                    <th>RA + RWR</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>QK<sup>T</sup> Complexity</strong></td>
                    <td>O(n¬≤d) - full matrix</td>
                    <td>O(nkd) - local + sparse (k‚â™n)</td>
                </tr>
                <tr>
                    <td><strong>Memory</strong></td>
                    <td>O(n¬≤) for attention matrix</td>
                    <td>O(nk) for local + sparse graph</td>
                </tr>
                <tr>
                    <td><strong>Long-range</strong></td>
                    <td>Direct QK<sup>T</sup> scoring</td>
                    <td>Multi-hop diffusion via RWR</td>
                </tr>
                <tr>
                    <td><strong>KV Cache</strong></td>
                    <td>Full history: O(nd)</td>
                    <td>Reduced via MLP context: 50-70% savings</td>
                </tr>
                <tr>
                    <td><strong>Convergence</strong></td>
                    <td>N/A (single pass)</td>
                    <td>Fast (reversible chain)</td>
                </tr>
            </tbody>
        </table>
        
        <div class="key-insight">
            <strong>üöÄ The Synergy:</strong>
            <ul style="margin: 10px 0 0 0;">
                <li><strong>RA provides reversibility</strong> ‚Üí RWR converges fast and stably</li>
                <li><strong>RWR provides sparsity</strong> ‚Üí Reduces O(n¬≤) to O(n) memory</li>
                <li><strong>Together they tile beautifully</strong> ‚Üí FlashAttention-style SRAM reuse + sparse matvecs</li>
                <li><strong>Route gate shifts to MLP</strong> ‚Üí Further reduces KV cache pressure</li>
            </ul>
            <p style="margin-top: 15px;">
                Result: Better quality (multi-hop reasoning) + better efficiency (sparse diffusion) + smaller cache (MLP context).
            </p>
        </div>
    </div>

    <div class="section">
        <h2>Summary: The Full Picture</h2>
        
        <svg width="100%" height="400" viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
            <!-- RA Layer -->
            <rect x="50" y="50" width="300" height="100" fill="#ffe6e6" stroke="#d17a4f" stroke-width="3" rx="8"/>
            <text x="200" y="85" text-anchor="middle" font-size="18" font-weight="bold" fill="#d17a4f">
                Reciprocal Attention (RA)
            </text>
            <text x="200" y="110" text-anchor="middle" font-size="14" fill="#333">
                S + S<sup>T</sup> + discoverability
            </text>
            <text x="200" y="130" text-anchor="middle" font-size="13" fill="#666">
                ‚Üí Reversible Markov Chain
            </text>
            
            <!-- Arrow down -->
            <path d="M 200 150 L 200 180" stroke="#334d5c" stroke-width="3" marker-end="url(#arrow-asym)"/>
            
            <!-- RWR Layer -->
            <rect x="50" y="180" width="300" height="100" fill="#e0f2f7" stroke="#5da5a5" stroke-width="3" rx="8"/>
            <text x="200" y="215" text-anchor="middle" font-size="18" font-weight="bold" fill="#5da5a5">
                Random Walk with Restart (RWR)
            </text>
            <text x="200" y="240" text-anchor="middle" font-size="14" fill="#333">
                Multi-step diffusion: r = Œ±Pr + (1-Œ±)e<sub>q</sub>
            </text>
            <text x="200" y="260" text-anchor="middle" font-size="13" fill="#666">
                ‚Üí Sparse O(n) attention
            </text>
            
            <!-- Arrow right -->
            <path d="M 350 230 L 440 230" stroke="#334d5c" stroke-width="3" marker-end="url(#arrow-asym)"/>
            
            <!-- Benefits box -->
            <rect x="440" y="50" width="310" height="230" fill="#f0f9e8" stroke="#27ae60" stroke-width="3" rx="8"/>
            <text x="595" y="85" text-anchor="middle" font-size="18" font-weight="bold" fill="#27ae60">
                Combined Benefits
            </text>
            
            <text x="460" y="120" font-size="14" fill="#333" font-weight="bold">‚úì Quality:</text>
            <text x="470" y="140" font-size="13" fill="#555">‚Ä¢ Bidirectional flow</text>
            <text x="470" y="158" font-size="13" fill="#555">‚Ä¢ Multi-hop reasoning</text>
            
            <text x="460" y="190" font-size="14" fill="#333" font-weight="bold">‚úì Efficiency:</text>
            <text x="470" y="210" font-size="13" fill="#555">‚Ä¢ O(n) memory not O(n¬≤)</text>
            <text x="470" y="228" font-size="13" fill="#555">‚Ä¢ Fast convergence</text>
            
            <text x="460" y="260" font-size="14" fill="#333" font-weight="bold">‚úì KV Cache:</text>
            <text x="470" y="278" font-size="13" fill="#555">‚Ä¢ 50-70% reduction via MLP</text>
            
            <!-- Bottom summary -->
            <text x="400" y="350" text-anchor="middle" font-size="16" font-weight="bold" fill="#334d5c">
                RA makes RWR mathematically clean. RWR makes attention computationally cheap.
            </text>
            <text x="400" y="375" text-anchor="middle" font-size="15" fill="#666">
                Together: Better models, smaller memory, faster inference.
            </text>
        </svg>
    </div>

</body>
</html>